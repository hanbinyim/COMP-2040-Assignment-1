import re
from collections import Counter

def read_file(filename= "input.txt"):
    with open(filename, 'r') as file:
        return file.read()

def get_words(text):
    return re.findall(r"[a-zA-Z]+", text.lower())

def word_count(words):
    return len(words)

def unique_word_count(words):
    return len(set(words))

def char_counts(text):
    with_spaces = len(text)
    no_spaces = len(re.sub(r'\s+', '', text))
    return with_spaces, no_spaces
                    
def average_word_length(words):        
    if not words:
        return 0
    total_chars = sum(len(word) for word in words)
    return total_chars / len(words)

def most_common_words(words):
    if not words:
        return [], 0
    word_counter = Counter(words)
    max_freq = max(word_counter.values())
    most_common = sorted([word for word, f in word_counter.items() if f == max_freq])
    return most_common, max_freq

def output(stats, filename="output.txt"):
    lines = [
        f"Word count: {stats['word_count']}",
        f"Unique words: {stats['unique_words']}",
        f"Characters (with spaces): {stats['chars_with_spaces']}",
        f"Characters (no spaces): {stats['chars_no_spaces']}",
        f"Average word length: {stats['avg_word_length']:.1f}",
        f"Most common word(s): {', '.join(stats['most_common_words'])} ({stats['most_common_freq']})"

    ]

# Output to Conosole and output.txt file
     # Console
    for line in lines:
        print(line)

    # File
    with open(filename, "w", encoding="utf-8") as f:
        f.write("\n".join(lines))

def main():
    text = read_file()
    words = get_words(text)

    wc = word_count(words)
    uwc = unique_word_count(words)
    chars_with_spaces, chars_no_spaces = char_counts(text)
    avg_len = average_word_length(words)
    common_words, freq = most_common_words(words)

    stats = {
        "word_count": wc,
        "unique_words": uwc,
        "chars_with_spaces": chars_with_spaces,
        "chars_no_spaces": chars_no_spaces,
        "avg_word_length": avg_len,
        "most_common_words": common_words,
        "most_common_freq": freq,
    }

    output(stats)

if __name__ == "__main__":
    main()